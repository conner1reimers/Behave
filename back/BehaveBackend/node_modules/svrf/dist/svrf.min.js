var Svrf=function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e};function n(e,t){return e(t={exports:{}},t.exports),t.exports}var o=n(function(e){!function(t){var r,n=Object.prototype,o=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag",c=t.regeneratorRuntime;if(c)e.exports=c;else{(c=t.regeneratorRuntime=e.exports).wrap=w;var f="suspendedStart",l="suspendedYield",p="executing",h="completed",d={},y={};y[a]=function(){return this};var v=Object.getPrototypeOf,m=v&&v(v(P([])));m&&m!==n&&o.call(m,a)&&(y=m);var g=S.prototype=E.prototype=Object.create(y);x.prototype=g.constructor=S,S.constructor=x,S[s]=x.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(g),e},c.awrap=function(e){return{__await:e}},k(O.prototype),O.prototype[u]=function(){return this},c.AsyncIterator=O,c.async=function(e,t,r,n){var o=new O(w(e,t,r,n));return c.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},k(g),g[s]="Generator",g[a]=function(){return this},g.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=P,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return u.type="throw",u.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),d}}}function w(e,t,r,n){var o=t&&t.prototype instanceof E?t:E,i=Object.create(o.prototype),a=new L(n||[]);return i._invoke=function(e,t,r){var n=f;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=T(a,r);if(u){if(u===d)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var s=b(e,t,r);if("normal"===s.type){if(n=r.done?h:l,s.arg===d)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=h,r.method="throw",r.arg=s.arg)}}}(e,r,a),i}function b(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function E(){}function x(){}function S(){}function k(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(e){var t;this._invoke=function(r,n){function i(){return new Promise(function(t,i){!function t(r,n,i,a){var u=b(e[r],e,n);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,i,a)},function(e){t("throw",e,i,a)}):Promise.resolve(c).then(function(e){s.value=e,i(s)},function(e){return t("throw",e,i,a)})}a(u.arg)}(r,n,t,i)})}return t=t?t.then(i,i):i()}}function T(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,T(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=b(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return i.next=i}}return{next:R}}function R(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())}),i=function(){return this||"object"==typeof self&&self}()||Function("return this")(),a=i.regeneratorRuntime&&Object.getOwnPropertyNames(i).indexOf("regeneratorRuntime")>=0,u=a&&i.regeneratorRuntime;i.regeneratorRuntime=void 0;var s=o;if(a)i.regeneratorRuntime=u;else try{delete i.regeneratorRuntime}catch(e){i.regeneratorRuntime=void 0}var c=s;function f(e,t,r,n,o,i,a){try{var u=e[i](a),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,o)}var l=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,u,"next",e)}function u(e){f(i,n,o,a,u,"throw",e)}a(void 0)})}},p=function(){function t(r,n,o){e(this,t),this.httpClient=r,this.tokenService=n,this.apiKey=o}return r(t,[{key:"authenticate",value:function(){var e=l(c.mark(function e(){var t;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tokenService.isTokenValid()){e.next=2;break}return e.abrupt("return");case 2:if(this.apiKey){e.next=4;break}throw new Error("Api Key should be provided for authentication");case 4:return this.authPromise||(this.authPromise=this.httpClient.post("/app/authenticate",{apiKey:this.apiKey})),e.next=7,this.authPromise;case 7:t=e.sent,this.tokenService.setAppTokenInfo({appToken:t.token,expiresIn:t.expiresIn}),delete this.authPromise;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();var h=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e};var d=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){h(e,t,r[t])})}return e};var y=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}};var v=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var m=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var g=function(e){return y(e)||v(e)||m()},w={category:{FACE_FILTERS:"Face Filters"},mediaType:{PHOTO:"photo",VIDEO:"video",MODEL_3D:"3d"},stereoscopicType:{NONE:"none",TOP_BOTTOM:"top-bottom",LEFT_RIGHT:"left-right"}},b=n(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(n){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?e.exports=r=function(e){return t(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},r(n)}e.exports=r}),E=function(){function t(){e(this,t)}return r(t,null,[{key:"isInteger",value:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}}]),t}(),x=function(){function t(){e(this,t)}return r(t,null,[{key:"includes",value:function(e,t){if(!Array.isArray(e))throw new TypeError("Passed value is not an array");return e.some(function(e){return e===t})}},{key:"find",value:function(e,t){if(!Array.isArray(e))throw new TypeError("Passed value is not an array");if("function"!=typeof t)throw new TypeError("Callback must be a function");for(var r=0;r<e.length;r+=1)if(t(e[r],r,e))return e[r];return null}}]),t}(),S=function(){function t(){e(this,t)}return r(t,null,[{key:"validateNumber",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.min,o=r.max;if(void 0!==t){if(!E.isInteger(t))throw new TypeError("".concat(e," should be an integer"));if(void 0!==n&&t<n)throw new RangeError("".concat(e," should be equal or more than ").concat(n));if(void 0!==o&&t>o)throw new RangeError("".concat(e," should be equal or less than ").concat(o))}}},{key:"validateEnumString",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0!==r){if(!t.isString(r))throw new TypeError("".concat(e," should be a string"));var o=Object.keys(n).map(function(e){return n[e]});if(!x.includes(o,r))throw new TypeError("".concat(e," should be one of the following values: ").concat(o.join(",")))}}},{key:"validateArrayOrSingleEnumString",value:function(e,r,n){if(void 0!==r)if(t.isString(r))t.validateEnumString(e,r,n);else{if(!Array.isArray(r))throw new TypeError("".concat(e," should be either an array or a string"));r.forEach(function(r,o){return t.validateEnumString("".concat(e,"[").concat(o,"]"),r,n)})}}},{key:"validateObjectSchema",value:function(e,r,n){var o=n.allowedKeys,i=n.requiredKeys;if("object"!==b(r))throw new TypeError("".concat(e," should be an object"));var a=Object.keys(r);o&&t.validateAllowedKeys(e,a,o),i&&t.validateRequiredKeys(e,a,i)}},{key:"validateAllowedKeys",value:function(e,t,r){var n=x.find(t,function(e){return!x.includes(r,e)});if(n)throw new TypeError("".concat(n," is not allowed in the ").concat(e," schema"))}},{key:"validateRequiredKeys",value:function(e,t,r){var n=x.find(r,function(e){return!x.includes(t,e)});if(n)throw new TypeError("".concat(n," is required in the ").concat(e," schema"))}},{key:"isString",value:function(e){return"[object String]"===Object.prototype.toString.call(e)}}]),t}(),k=function(){function t(){e(this,t)}return r(t,null,[{key:"validateParams",value:function(e){e&&(S.validateObjectSchema("Query Params",e,{allowedKeys:t.allowedParams}),S.validateEnumString("category",e.category,w.category),S.validateNumber("minimumWidth",e.minimumWidth),S.validateNumber("pageNum",e.pageNum,{min:0}),S.validateNumber("size",e.size,{min:1,max:100}),S.validateEnumString("stereoscopic type",e.stereoscopicType,w.stereoscopicType),S.validateArrayOrSingleEnumString("type",e.type,w.mediaType))}},{key:"prepareQueryParams",value:function(e){var r=d({},e);return e&&Array.isArray(e.type)&&(r.type=e.type.join(",")),t.booleanParams.forEach(function(e){void 0!==r[e]&&(r[e]=!!r[e])}),r}}]),t}();h(k,"booleanParams",["isFaceFilter","hasBlendShapes","requiresBlendShapes"]),h(k,"allowedParams",[].concat(g(k.booleanParams),["category","minimumWidth","pageNum","size","stereoscopicType","type"]).sort());var O=function(){function t(r){e(this,t),this.httpClient=r}return r(t,[{key:"getById",value:function(){var e=l(c.mark(function e(t){return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Media Id should be provided");case 2:return e.abrupt("return",this.httpClient.get("/vr/".concat(t)));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTrending",value:function(){var e=l(c.mark(function e(t){var r;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k.validateParams(t),r=k.prepareQueryParams(t),e.abrupt("return",this.httpClient.get("/vr/trending",r));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=l(c.mark(function e(t,r){var n;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("query should be provided");case 2:return k.validateParams(r),n=k.prepareQueryParams(r),e.abrupt("return",this.httpClient.get("/vr/search",d({q:t},n)));case 5:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()}]),t}();var T=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var j=function(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?T(e):t},A=n(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(r)}e.exports=t}),L=n(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(r,n)}e.exports=t});var P=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)},R=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},C=Object.prototype.toString;function _(e){return"[object Array]"===C.call(e)}function N(e){return null!==e&&"object"==typeof e}function I(e){return"[object Function]"===C.call(e)}function F(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),_(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var q={isArray:_,isArrayBuffer:function(e){return"[object ArrayBuffer]"===C.call(e)},isBuffer:function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:N,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===C.call(e)},isFile:function(e){return"[object File]"===C.call(e)},isBlob:function(e){return"[object Blob]"===C.call(e)},isFunction:I,isStream:function(e){return N(e)&&I(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:F,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,o=arguments.length;n<o;n++)F(arguments[n],r);return t},extend:function(e,t,r){return F(t,function(t,n){e[n]=r&&"function"==typeof t?R(t,r):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}},B=function(e,t,r,n,o){return function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e}(new Error(e),t,r,n,o)};function U(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var D=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],K=q.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=q.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},G=q.isStandardBrowserEnv()?{write:function(e,t,r,n,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),q.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),q.isString(n)&&a.push("path="+n),q.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},H=function(e){return new Promise(function(t,r){var n=e.data,o=e.headers;q.isFormData(n)&&delete o["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var a=e.auth.username||"",u=e.auth.password||"";o.Authorization="Basic "+btoa(a+":"+u)}if(i.open(e.method.toUpperCase(),function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(q.isURLSearchParams(t))n=t.toString();else{var o=[];q.forEach(t,function(e,t){null!=e&&(q.isArray(e)?t+="[]":e=[e],q.forEach(e,function(e){q.isDate(e)?e=e.toISOString():q.isObject(e)&&(e=JSON.stringify(e)),o.push(U(t)+"="+U(e))}))}),n=o.join("&")}return n&&(e+=(-1===e.indexOf("?")?"?":"&")+n),e}(e.url,e.params,e.paramsSerializer),!0),i.timeout=e.timeout,i.onreadystatechange=function(){if(i&&4===i.readyState&&(0!==i.status||i.responseURL&&0===i.responseURL.indexOf("file:"))){var n,o,a,u,s,c="getAllResponseHeaders"in i?(n=i.getAllResponseHeaders(),s={},n?(q.forEach(n.split("\n"),function(e){if(u=e.indexOf(":"),o=q.trim(e.substr(0,u)).toLowerCase(),a=q.trim(e.substr(u+1)),o){if(s[o]&&D.indexOf(o)>=0)return;s[o]="set-cookie"===o?(s[o]?s[o]:[]).concat([a]):s[o]?s[o]+", "+a:a}}),s):s):null,f={data:e.responseType&&"text"!==e.responseType?i.response:i.responseText,status:i.status,statusText:i.statusText,headers:c,config:e,request:i};!function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(B("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}(t,r,f),i=null}},i.onerror=function(){r(B("Network Error",e,null,i)),i=null},i.ontimeout=function(){r(B("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",i)),i=null},q.isStandardBrowserEnv()){var s=G,c=(e.withCredentials||K(e.url))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;c&&(o[e.xsrfHeaderName]=c)}if("setRequestHeader"in i&&q.forEach(o,function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete o[t]:i.setRequestHeader(t,e)}),e.withCredentials&&(i.withCredentials=!0),e.responseType)try{i.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&i.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){i&&(i.abort(),r(e),i=null)}),void 0===n&&(n=null),i.send(n)})},z={"Content-Type":"application/x-www-form-urlencoded"};function M(e,t){!q.isUndefined(e)&&q.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var V,Y={adapter:("undefined"!=typeof XMLHttpRequest?V=H:"undefined"!=typeof process&&(V=H),V),transformRequest:[function(e,t){return function(e,t){q.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}(t,"Content-Type"),q.isFormData(e)||q.isArrayBuffer(e)||q.isBuffer(e)||q.isStream(e)||q.isFile(e)||q.isBlob(e)?e:q.isArrayBufferView(e)?e.buffer:q.isURLSearchParams(e)?(M(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):q.isObject(e)?(M(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};Y.headers={common:{Accept:"application/json, text/plain, */*"}},q.forEach(["delete","get","head"],function(e){Y.headers[e]={}}),q.forEach(["post","put","patch"],function(e){Y.headers[e]=q.merge(z)});var J=Y;function X(){this.handlers=[]}X.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},X.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},X.prototype.forEach=function(e){q.forEach(this.handlers,function(t){null!==t&&e(t)})};var Q=X,$=function(e,t,r){return q.forEach(r,function(r){e=r(e,t)}),e},W=function(e){return!(!e||!e.__CANCEL__)};function Z(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var ee=function(e){var t,r,n;return Z(e),e.baseURL&&(n=e.url,!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(n))&&(e.url=(t=e.baseURL,(r=e.url)?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t)),e.headers=e.headers||{},e.data=$(e.data,e.headers,e.transformRequest),e.headers=q.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),q.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||J.adapter)(e).then(function(t){return Z(e),t.data=$(t.data,t.headers,e.transformResponse),t},function(t){return W(t)||(Z(e),t&&t.response&&(t.response.data=$(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})};function te(e){this.defaults=e,this.interceptors={request:new Q,response:new Q}}te.prototype.request=function(e){"string"==typeof e&&(e=q.merge({url:arguments[0]},arguments[1])),(e=q.merge(J,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[ee,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},q.forEach(["delete","get","head","options"],function(e){te.prototype[e]=function(t,r){return this.request(q.merge(r||{},{method:e,url:t}))}}),q.forEach(["post","put","patch"],function(e){te.prototype[e]=function(t,r,n){return this.request(q.merge(n||{},{method:e,url:t,data:r}))}});var re=te;function ne(e){this.message=e}ne.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},ne.prototype.__CANCEL__=!0;var oe=ne;function ie(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new oe(e),t(r.reason))})}ie.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ie.source=function(){var e;return{token:new ie(function(t){e=t}),cancel:e}};var ae=ie;function ue(e){var t=new re(e),r=R(re.prototype.request,t);return q.extend(r,re.prototype,t),q.extend(r,t),r}var se=ue(J);se.Axios=re,se.create=function(e){return ue(q.merge(J,e))},se.Cancel=oe,se.CancelToken=ae,se.isCancel=W,se.all=function(e){return Promise.all(e)},se.spread=function(e){return function(t){return e.apply(null,t)}};var ce=se,fe=se;ce.default=fe;var le=ce,pe="https://api.svrf.com/v1",he=function(){function t(){e(this,t),this.api=le.create(),this.api.defaults.baseURL=pe}return r(t,[{key:"get",value:function(){var e=l(c.mark(function e(t,r){var n;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get(t,{params:r});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=l(c.mark(function e(t,r){var n;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post(t,r);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()}]),t}(),de=function(t){function r(t,n){var o;return e(this,r),(o=j(this,A(r).call(this))).api.interceptors.request.use(function(){var e=l(c.mark(function e(r){var o;return c.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.authenticate();case 2:return o=n.getAppToken(),r.headers["x-app-token"]=o,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),o}return P(r,he),r}(),ye=function(){function t(r){e(this,t),this.storage=r}return r(t,[{key:"isTokenValid",value:function(){var e=this.getInfoFromStorage(),t=e.appToken,r=e.expirationTime,n=t&&r&&r>Date.now();return!!n}},{key:"getAppToken",value:function(){return this.getInfoFromStorage().appToken}},{key:"setAppTokenInfo",value:function(e){var t=e.appToken,r=e.expiresIn,n=Date.now()+r;this.storage.set({appToken:t,expirationTime:n})}},{key:"clearAppTokenInfo",value:function(){this.storage.clear()}},{key:"getInfoFromStorage",value:function(){return this.storage.get()||{}}}]),t}(),ve=function(){function t(){e(this,t)}return r(t,null,[{key:"get",value:function(){var e=localStorage.getItem(t.LOCAL_STORAGE_KEY);return JSON.parse(e)}},{key:"set",value:function(e){var r=JSON.stringify(e);localStorage.setItem(t.LOCAL_STORAGE_KEY,r)}},{key:"clear",value:function(){localStorage.removeItem(t.LOCAL_STORAGE_KEY)}}]),t}();h(ve,"LOCAL_STORAGE_KEY","svrf-app-token");var me=function(){function t(){e(this,t)}return r(t,null,[{key:"get",value:function(){return t.appTokenInfo}},{key:"set",value:function(e){t.appTokenInfo=e}},{key:"clear",value:function(){t.appTokenInfo=null}}]),t}();h(me,"appTokenInfo",null);var ge="undefined"==typeof localStorage?me:ve,we=function(){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.isManualAuthentication,i=n.storage;if(e(this,t),i){var a=["get","set","clear"];S.validateObjectSchema("User Storage",i,{allowedKeys:a,requiredKeys:a})}var u=new ye(i||ge),s=new he;this.auth=new p(s,u,r);var c=new de(this.auth,u);this.media=new O(c),o||this.authenticate()}return r(t,[{key:"authenticate",value:function(){return this.auth.authenticate()}}]),t}();return we.enums=w,we}();
